Short-text classification is an important task in many areas of natural language processing, includ- ing sentiment analysis, question answering, or dia- log management. Many different approaches have been developed for short-text classification, such as using Support Vector Machines (SVMs) with rule-based features (Silva et al., 2011), combin- ing SVMs with naive Bayes ( Wang and Manning, 2012), and building dependency trees with Con- ditional Random Fields ( Nakagawa et al., 2010). Several recent studies using ANNs have shown promising results, including convolutional neural networks (CNNs) (Kim, 2014;Blunsom et al., 2014;Kalchbrenner et al., 2014) and recursive neural net- works ( Socher et al., 2012).Most ANN systems classify short texts in isola- tion, i.e., without considering preceding short texts.However, short texts usually appear in sequence (e.g., sentences in a document or utterances in a di- alog), therefore using information from preceding short texts may improve the classification accuracy. Previous works on sequential short-text classifica- tion are mostly based on non-ANN approaches, such as Hidden Markov Models (HMMs) (Reithinger and Klesen, 1997), ( Stolcke et al., 2000), maximum en- tropy ( Ang et al., 2005), and naive Bayes ( Lendvai and Geertzen, 2007).Inspired by the performance of ANN-based sys- tems for non-sequential short-text classification, we introduce a model based on recurrent neural net- works (RNNs) and CNNs for sequential short-text classification, and evaluate it on the dialog act classi- fication task. A dialog act characterizes an utterance in a dialog based on a combination of pragmatic, se- mantic, and syntactic criteria. Its accurate detection is useful for a range of applications, from speech recognition to automatic summarization ( Stolcke et al., 2000). Our model achieves state-of-the-art re- sults on three different datasets.2 Model * These authors contributed equally to this work.Our model comprises two parts. The first part gener- ates a vector representation for each short text using either the RNN or CNN architecture, as discussed in Section 2.1 and Figure 1. The second part classifies the current short text based on the vector representa- tions of the current as well as a few preceding short texts, as presented in Section 2.2 and Figure 2.We denote scalars with italic lowercases (e.g., k, b f ), vectors with bold lowercases (e.g., s, x i ), and matrices with italic uppercases (e.g., W f ). We   use the colon notation v i:j to denote the sequence of vectors (v i , v i+1 , . . . , v j ).A given short text of length is represented as the se- quence of m-dimensional word vectors x 1: , which is used by the RNN or CNN model to produce the n-dimensional short-text representation s.The symbols σ(·) and tanh(·) refer to the element- wise sigmoid and hyperbolic tangent functions, and is the element-wise multiplication. h 0 = c 0 = 0.In the pooling layer, the sequence of vectors h 1: output from the RNN layer are combined into a sin- gle vector s ∈ R n that represents the short-text, us- ing one of the following mechanisms: last, mean, and max pooling. Last pooling takes the last vector, i.e., s = h , mean pooling averages all vectors, i.e., s =We use a variant of RNN called Long Short Term Memory (LSTM) (Hochreiter and Schmidhuber, 1997). For the t th word in the short-text, an LSTM takes as input x t , h t−1 , c t−1 and produces h t , c t based on the following formulas: t=1 h t , and max pooling takes the element- wise maximum of h 1: .Using a filter W f ∈ R h×m of height h, a convolu- tion operation on h consecutive word vectors start- ing from t th word outputs the scalar featurewhere W j ∈ R n×m , U j ∈ R n×n are weight matri- ces and b j ∈ R n are bias vectors, for j ∈ {i, f, c, o}.where X t:t+h−1 ∈ R h×m is the matrix whose i th row is x i ∈ R m , and b f ∈ R is a bias. The symbol • refers to the dot product and ReLU(·) is the element- wise rectified linear unit function.We perform convolution operations with n dif- ferent filters, and denote the resulting features as c t ∈ R n , each of whose dimensions comes from a distinct filter. Repeating the convolution operations for each window of h consecutive words in the short- text, we obtain c 1: . The short-text representa- tion s ∈ R n is computed in the max pooling layer, as the element-wise maximum of c 1: .For MRDA, we use the train/validation/test splits provided with the datasets. For DSTC 4 and SwDA, only the train/test splits are provided. 1  where W 0 , W −1 , W −2 ∈ R k×n are the weight ma- trices, b 1 ∈ R k is the bias vector, y j ∈ R k is the class representation, and k is the number of classes for the classification task. Similarly, the second layer takes as input the se- quence of class representations y i−d 2 :i and outputsThe model is trained to minimize the negative log- likelihood of predicting the correct dialog acts of the utterances in the train set, using stochastic gradient descent with the Adadelta update rule (Zeiler, 2012). At each gradient descent step, weight matrices, bias vectors, and word vectors are updated. For regular- ization, dropout is applied after the pooling layer, and early stopping is used on the validation set with a patience of 10 epochs.To find effective hyperparameters, we varied one hy- perparameter at a time while keeping the other ones fixed. Table 2 presents our hyperparameter choices.where U 0 , U −1 , U −2 ∈ R k×k and b 2 ∈ R k are the weight matrices and bias vector.The final output z i represents the probability dis- tribution over the set of k classes for the i th short- text: the j th element of z i corresponds to the proba- bility that the i th short-text belongs to the j th class. We evaluate our model on the dialog act classifica- tion task using the following datasets:• DSTC 4: Dialog State Tracking Challenge 4 ( Kim et al., 2015;Kim et al., 2016).• MRDA: ICSI Meeting Recorder Dialog Act Cor- pus ( Janin et al., 2003;Shriberg et al., 2004). The 5 classes are introduced in ( Ang et al., 2005).• SwDA: Switchboard Dialog Act Corpus ( Jurafsky et al., 1997). We initialized the word vectors with the 300- dimensional word vectors pretrained with word2vec on Google News ( Mikolov et al., 2013a;Mikolov et al., 2013b) for DSTC 4, and the 200-dimensional  Table 3: Accuracy (%) on different architectures and history sizes d1, d2. For each setting, we report average (minimum, maximum) computed on 5 runs. Sequential classification (d1 + d2 &gt; 0) outperforms non-sequential classification (d1 = d2 = 0). Overall, the CNN model outperformed the LSTM model for all datasets, albeit by a small margin except for SwDA. We also tried a variant of the LSTM model, gated recurrent units ( Cho et al., 2014), but the results were generally lower than LSTM.word vectors pretrained with GloVe on Twit- ter ( Pennington et al., 2014) for MRDA and SwDA, as these choices yielded the best results among all publicly available word2vec, GloVe, SENNA (Collobert, 2011;Collobert et al., 2011) and RNNLM (Mikolov et al., 2011) word vectors. The effects of the history sizes d 1 and d 2 for the short-text and the class representations, respectively, are presented in Table 3 for both the LSTM and CNN models. In both models, increasing d 1 while keeping d 2 = 0 improved the performances by 1.3- 4.2 percentage points. Conversely, increasing d 2 while keeping d 1 = 0 yielded better results, but the performance increase was less pronounced: incor- porating sequential information at the short-text rep- resentation level was more effective than at the class representation level.Using sequential information at both the short- text representation level and the class representa- tion level does not help in most cases and may even lower the performances. We hypothesize that short- text representations contain richer and more gen- eral information than class representations due to their larger dimension. Class representations may not convey any additional information over short- text representations, and are more likely to propa- gate errors from previous misclassifications. Table 4 compares our results with the state-of-the- art. Overall, our model shows competitive results, while requiring no human-engineered features. Rig- orous comparisons are challenging to draw, as many important details such as text preprocessing and train/valid/test split may vary, and many studies fail to perform several runs despite the randomness in some parts of the training process, such as weight initialization. Interlabeler agreement - - 84.0 Table 4: Accuracy (%) of our models and other methods from the literature. The majority class model predicts the most fre- quent class. SVM: (Dernoncourt et al., 2016). Graphical model: (Ji and Bilmes, 2006). Naive Bayes: (Lendvai and Geertzen, 2007). HMM: ( Stolcke et al., 2000). Memory-based Learning: (Rotaru, 2002). All five models use features derived from tran- scribed words, as well as previous predicted dialog acts except for Naive Bayes. The interlabeler agreement could be obtained only for SwDA. For the CNN and LSTM models, the presented results are the test set accuracy of the run with the highest accu- racy on the validation set.In this article we have presented an ANN-based ap- proach to sequential short-text classification. We demonstrate that adding sequential information im- proves the quality of the predictions, and the per- formance depends on what sequential information is used in the model. Our model achieves state-of-the- art results on three different datasets for dialog act prediction.
